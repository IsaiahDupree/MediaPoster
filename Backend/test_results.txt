============================= test session starts ==============================
platform darwin -- Python 3.14.0, pytest-9.0.1, pluggy-1.6.0 -- /opt/homebrew/opt/python@3.14/bin/python3.14
cachedir: .pytest_cache
rootdir: /Users/isaiahdupree/Documents/Software/MediaPoster/Backend
plugins: asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 15 items

tests/integration/test_workspace_endpoints_integration.py::test_create_segment_in_workspace ERROR [  6%]
tests/integration/test_workspace_endpoints_integration.py::test_workspace_isolation_segments ERROR [ 13%]
tests/integration/test_workspace_endpoints_integration.py::test_create_person_in_workspace ERROR [ 20%]
tests/integration/test_workspace_endpoints_integration.py::test_workspace_isolation_people ERROR [ 26%]
tests/integration/test_workspace_endpoints_integration.py::test_cascade_delete_workspace ERROR [ 33%]
tests/integration/test_workspace_endpoints_integration.py::test_workspace_member_count ERROR [ 40%]
tests/security/test_rls_security.py::test_workspace_id_required_for_segments ERROR [ 46%]
tests/security/test_rls_security.py::test_sql_injection_workspace_name ERROR [ 53%]
tests/security/test_rls_security.py::test_workspace_cross_access_prevention ERROR [ 60%]
tests/security/test_rls_security.py::test_xss_prevention_workspace_description ERROR [ 66%]
tests/security/test_rls_security.py::test_workspace_slug_uniqueness ERROR [ 73%]
tests/security/test_rls_security.py::test_helper_function_user_workspaces_exists ERROR [ 80%]
tests/security/test_rls_security.py::test_helper_function_safe_user_id_exists ERROR [ 86%]
tests/security/test_rls_security.py::test_rls_enabled_on_workspaces ERROR [ 93%]
tests/security/test_rls_security.py::test_overly_long_workspace_name ERROR [100%]

==================================== ERRORS ====================================
______________ ERROR at setup of test_create_segment_in_workspace ______________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_____________ ERROR at setup of test_workspace_isolation_segments ______________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
______________ ERROR at setup of test_create_person_in_workspace _______________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
______________ ERROR at setup of test_workspace_isolation_people _______________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_______________ ERROR at setup of test_cascade_delete_workspace ________________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
________________ ERROR at setup of test_workspace_member_count _________________
tests/integration/test_workspace_endpoints_integration.py:22: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
__________ ERROR at setup of test_workspace_id_required_for_segments ___________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_____________ ERROR at setup of test_sql_injection_workspace_name ______________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
___________ ERROR at setup of test_workspace_cross_access_prevention ___________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_________ ERROR at setup of test_xss_prevention_workspace_description __________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_______________ ERROR at setup of test_workspace_slug_uniqueness _______________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
________ ERROR at setup of test_helper_function_user_workspaces_exists _________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
__________ ERROR at setup of test_helper_function_safe_user_id_exists __________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
_______________ ERROR at setup of test_rls_enabled_on_workspaces _______________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
______________ ERROR at setup of test_overly_long_workspace_name _______________
tests/security/test_rls_security.py:23: in db_session
    engine = create_async_engine(DATABASE_URL)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:121: in create_async_engine
    return AsyncEngine(sync_engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/lib/python3.14/site-packages/sqlalchemy/ext/asyncio/engine.py:1035: in __init__
    raise exc.InvalidRequestError(
E   sqlalchemy.exc.InvalidRequestError: The asyncio extension requires an async driver to be used. The loaded 'psycopg2' is not async.
=============================== warnings summary ===============================
database/models.py:18
  /Users/isaiahdupree/Documents/Software/MediaPoster/Backend/database/models.py:18: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR tests/integration/test_workspace_endpoints_integration.py::test_create_segment_in_workspace
ERROR tests/integration/test_workspace_endpoints_integration.py::test_workspace_isolation_segments
ERROR tests/integration/test_workspace_endpoints_integration.py::test_create_person_in_workspace
ERROR tests/integration/test_workspace_endpoints_integration.py::test_workspace_isolation_people
ERROR tests/integration/test_workspace_endpoints_integration.py::test_cascade_delete_workspace
ERROR tests/integration/test_workspace_endpoints_integration.py::test_workspace_member_count
ERROR tests/security/test_rls_security.py::test_workspace_id_required_for_segments
ERROR tests/security/test_rls_security.py::test_sql_injection_workspace_name
ERROR tests/security/test_rls_security.py::test_workspace_cross_access_prevention
ERROR tests/security/test_rls_security.py::test_xss_prevention_workspace_description
ERROR tests/security/test_rls_security.py::test_workspace_slug_uniqueness - s...
ERROR tests/security/test_rls_security.py::test_helper_function_user_workspaces_exists
ERROR tests/security/test_rls_security.py::test_helper_function_safe_user_id_exists
ERROR tests/security/test_rls_security.py::test_rls_enabled_on_workspaces - s...
ERROR tests/security/test_rls_security.py::test_overly_long_workspace_name - ...
======================== 1 warning, 15 errors in 16.30s ========================
